var V=Object.defineProperty,B=Object.defineProperties;var F=Object.getOwnPropertyDescriptors;var T=Object.getOwnPropertySymbols;var j=Object.prototype.hasOwnProperty,E=Object.prototype.propertyIsEnumerable;var z=(o,e,t)=>e in o?V(o,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):o[e]=t,m=(o,e)=>{for(var t in e||(e={}))j.call(e,t)&&z(o,t,e[t]);if(T)for(var t of T(e))E.call(e,t)&&z(o,t,e[t]);return o},w=(o,e)=>B(o,F(e));import{a as x,c as G,u as H,d as C,b as y,r as g,w as L,o as $,e as h,f as _,g as I,h as A,T as P,i as a,j as K,k as U,v as q,F as b,l as O,t as p,m as R,n as W,p as Y}from"./vendor.855f03bf.js";const J=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))l(s);new MutationObserver(s=>{for(const c of s)if(c.type==="childList")for(const i of c.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&l(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const c={};return s.integrity&&(c.integrity=s.integrity),s.referrerpolicy&&(c.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?c.credentials="include":s.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function l(s){if(s.ep)return;s.ep=!0;const c=t(s);fetch(s.href,c)}};J();const Q={},X={},Z={lave:{},food:{}};var S;(function(o){o.setConfig="setConfig"})(S||(S={}));const ee={[S.setConfig]:async({state:o},e)=>{var t,l,s,c,i,u;if(e=Object.fromEntries(Object.entries(e).map(([d,n])=>[d,Object.fromEntries(Object.entries(n).map(([f,r])=>[f,r===null?void 0:r]))])),((t=e.food)==null?void 0:t.schoolName)!==((l=o.food)==null?void 0:l.schoolName)&&((s=e.food)==null?void 0:s.schoolName)||((c=e.food)==null?void 0:c.schoolId)!==((i=o.food)==null?void 0:i.schoolId)&&((u=e.food)==null?void 0:u.schoolId)){const{data:d}=await x({url:`https://fatraceschool.k12ea.gov.tw/school?SchoolName=${e.food.schoolName}`,method:"GET"});let{data:n}=d;e||(e={food:{},lave:{}}),console.log(n),n.length&&(e.$_updata=!0,e.food.schoolId=n[0].SchoolId.toString(),e.food.schoolName=n[0].SchoolName)}e.$_updata!==!1&&chrome.storage&&chrome.storage.local.set({config:e}),o.food=m(m({},o.food),e.food),o.lave=m(m({},o.lave),e.lave)}},te={namespaced:!0,mutations:X,getters:Q,state:Z,actions:ee};var D;(function(o){o.CONFIG="config"})(D||(D={}));const oe=G({modules:{[D.CONFIG]:te}}),M=Symbol("vue-store"),N=()=>H(M);const se={key:0,class:"menu"},ne={class:"content"},ce={class:"cover"},ae=["src"],le={class:"flex flex-down flex-item-center"},ie=["textContent"],re=["textContent"],de={key:0,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#fff"},ue=a("path",{d:"M0 0h24v24H0V0zm0 0h24v24H0V0zm0 0h24v24H0V0zm0 0h24v24H0V0z",fill:"none"},null,-1),fe=a("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6zm-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14zM2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45 2.01 3.87zm7.5 7.5l2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13zm-3.4-3.4l1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53z"},null,-1),he=[ue,fe],_e={key:1,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#fff"},me=a("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1),pe=a("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7z"},null,-1),ve=[me,pe],ge=C({setup(o){const e=N(),t=y(()=>e.state.config.food.schoolId),l=g();L(t,()=>s()),$(()=>clearInterval(c));const s=async()=>{var f;let u=new Date;const{data:d}=await x({url:`https://fatraceschool.k12ea.gov.tw/offered/meal?SchoolId=${t.value}&period=${[u.getFullYear(),u.getMonth()+1,u.getDate()].join("-")}&KitchenId=all`,method:"GET"});let n=(f=d==null?void 0:d.data)==null?void 0:f[0];if(n){const{data:r}=await x({url:`https://fatraceschool.k12ea.gov.tw/dish?BatchDataId=${n.BatchDataId}`,method:"GET"});l.value=r==null?void 0:r.data}},c=setInterval(s,1e3*60*10);s();const i=g();return(u,d)=>l.value?(h(),_("div",se,[I(P,{name:"content"},{default:A(()=>[U(a("div",ne,[(h(!0),_(b,null,O(l.value,(n,f)=>(h(),_("div",{class:"dish",key:f},[a("div",ce,[a("img",{src:`https://fatraceschool.k12ea.gov.tw/dish/pic/${n.DishId}`,alt:"\u83DC\u8272\u5716\u7247"},null,8,ae)]),a("div",le,[a("span",{textContent:p(n.DishType)},null,8,ie),a("span",{textContent:p(n.DishName)},null,8,re)])]))),128))],512),[[q,i.value]])]),_:1}),a("div",{class:"type",onClick:d[0]||(d[0]=n=>i.value=!i.value)},[i.value?(h(),_("svg",de,he)):(h(),_("svg",_e,ve))])])):K("",!0)}});var we=(o,e)=>{const t=o.__vccOpts||o;for(const[l,s]of e)t[l]=s;return t};const xe={class:"lave flex flex-item-center flex-center flex-down"},Ce=["textContent"],ye={class:"flex"},$e=["textContent"],Ie=["textContent"],Se=C({setup(o){const e=N(),t=y(()=>e.state.config.lave.laveTime);L(t,n=>n&&(s.value=n));const l=y(()=>e.state.config.lave.title||"\u6703\u8003\u5269\u9918"),s=g("2022-05-21T00:00:00+08:00"),c=g(),i=["\u5929","\u5C0F\u6642","\u5206\u9418","\u79D2"],u=()=>{let n=new Date(s.value).getTime()-new Date().getTime();c.value=[n/(1e3*60*60*24),n%(1e3*60*60*24)/(1e3*60*60),n%(1e3*60*60)/(1e3*60),n%(1e3*60)/1e3].map(r=>(~~r).toString().padStart(2,"0"));let f=c.value.map((r,v)=>[v,+r]).filter(([,r])=>r!==0)[0];document.title=`${l.value} ${f[1]||""}${i[f[0]]}`};u();const d=setInterval(u,100);return $(()=>clearInterval(d)),(n,f)=>(h(),_("div",xe,[a("div",{class:"title",textContent:p(R(l))},null,8,Ce),a("div",ye,[(h(),_(b,null,O(i,(r,v)=>{var k;return a("div",{class:"flex",key:v},[a("span",{class:"time",textContent:p((k=c.value)==null?void 0:k[v])},null,8,$e),a("span",{textContent:p(r)},null,8,Ie)])}),64))])]))}});var De=we(Se,[["__scopeId","data-v-caab62ca"]]);const Ne={class:"wrapper"},ke=C({setup(o){const e=N();return W(()=>{if(chrome.storage&&location.href.startsWith("chrome"))chrome.storage.onChanged.addListener(async({config:t})=>{t&&await e.dispatch("config/setConfig",w(m({},t.newValue),{$_updata:!1}))}),chrome.storage.local.get("config",({config:t})=>{t&&e.dispatch("config/setConfig",w(m({},t),{$_updata:!1}))});else{let t=new URL(location.href).searchParams;e.dispatch("config/setConfig",{lave:{title:t.get("endTitle"),laveTime:t.get("endTime")},food:{schoolId:t.get("foodSchoolId"),schoolName:t.get("foodSchoolName")},$_updata:!1})}}),$(()=>{}),(t,l)=>(h(),_("div",Ne,[I(De),I(ge)]))}});Y(ke).use(oe,M).mount("#app");
