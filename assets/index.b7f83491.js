var Y=Object.defineProperty,Q=Object.defineProperties;var X=Object.getOwnPropertyDescriptors;var G=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,ee=Object.prototype.propertyIsEnumerable;var H=(t,e,o)=>e in t?Y(t,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):t[e]=o,_=(t,e)=>{for(var o in e||(e={}))Z.call(e,o)&&H(t,o,e[o]);if(G)for(var o of G(e))ee.call(e,o)&&H(t,o,e[o]);return t},y=(t,e)=>Q(t,X(e));import{a as S,c as te,u as oe,d as N,b as $,r as g,w as C,o as b,e as M,f as v,g as m,h as D,i as se,T as le,j as l,k as B,l as I,v as U,F as L,m as O,t as w,p as K,n as P,q as x,s as q,x as F,y as J,z as ne}from"./vendor.d81721fa.js";const ce=function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))i(n);new MutationObserver(n=>{for(const c of n)if(c.type==="childList")for(const u of c.addedNodes)u.tagName==="LINK"&&u.rel==="modulepreload"&&i(u)}).observe(document,{childList:!0,subtree:!0});function o(n){const c={};return n.integrity&&(c.integrity=n.integrity),n.referrerpolicy&&(c.referrerPolicy=n.referrerpolicy),n.crossorigin==="use-credentials"?c.credentials="include":n.crossorigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function i(n){if(n.ep)return;n.ep=!0;const c=o(n);fetch(n.href,c)}};ce();const ae={};var V;(function(t){t.editConfig="editConfig"})(V||(V={}));const ie={[V.editConfig](t,e){t.food=_(_({},e==null?void 0:e.food),t.food),t.lave=_(_({},e==null?void 0:e.lave),t.lave)}},de={lave:{},food:{}};var A;(function(t){t.setConfig="setConfig"})(A||(A={}));const re={[A.setConfig]:async({state:t},e)=>{var o,i,n,c,u,f;if(e=Object.fromEntries(Object.entries(e).map(([p,s])=>[p,Object.fromEntries(Object.entries(s).map(([h,d])=>[h,d===null?void 0:d]))])),((o=e.food)==null?void 0:o.schoolName)!==((i=t.food)==null?void 0:i.schoolName)&&((n=e.food)==null?void 0:n.schoolName)||((c=e.food)==null?void 0:c.schoolId)!==((u=t.food)==null?void 0:u.schoolId)&&((f=e.food)==null?void 0:f.schoolId)){const{data:p}=await S({url:`https://fatraceschool.k12ea.gov.tw/school?SchoolName=${e.food.schoolName}`,method:"GET"});let{data:s}=p;e||(e={food:{},lave:{}}),console.log(s),s.length&&(e.$_updata=!0,e.food.schoolId=s[0].SchoolId.toString(),e.food.schoolName=s[0].SchoolName)}e.$_updata!==!1&&((chrome==null?void 0:chrome.storage)?chrome.storage.local.set({config:e}):localStorage.setItem("config",JSON.stringify(e))),t.food=_(_({},t.food),e.food),t.lave=_(_({},t.lave),e.lave)}},ue={namespaced:!0,mutations:ie,getters:ae,state:de,actions:re};var E;(function(t){t.CONFIG="config"})(E||(E={}));const fe=te({modules:{[E.CONFIG]:ue}}),R=Symbol("vue-store"),k=()=>oe(R);var j=(t,e)=>{const o=t.__vccOpts||t;for(const[i,n]of e)o[i]=n;return o};const T=t=>(K("data-v-35beb1d5"),t=t(),P(),t),he={key:0,class:"menu"},pe={class:"content"},_e={class:"cover"},ve=["src"],me={class:"flex flex-down flex-item-center"},ge=["textContent"],Ce=["textContent"],we={key:0,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#fff"},xe=T(()=>l("path",{d:"M0 0h24v24H0V0zm0 0h24v24H0V0zm0 0h24v24H0V0zm0 0h24v24H0V0z",fill:"none"},null,-1)),ye=T(()=>l("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5-.59 1.22-1.42 2.27-2.41 3.12l1.41 1.41c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l1.65 1.65C10.66 6.09 11.32 6 12 6zm-1.07 1.14L13 9.21c.57.25 1.03.71 1.28 1.28l2.07 2.07c.08-.34.14-.7.14-1.07C16.5 9.01 14.48 7 12 7c-.37 0-.72.05-1.07.14zM2.01 3.87l2.68 2.68C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.98-.29 4.32-.82l3.42 3.42 1.41-1.41L3.42 2.45 2.01 3.87zm7.5 7.5l2.61 2.61c-.04.01-.08.02-.12.02-1.38 0-2.5-1.12-2.5-2.5 0-.05.01-.08.01-.13zm-3.4-3.4l1.75 1.75c-.23.55-.36 1.15-.36 1.78 0 2.48 2.02 4.5 4.5 4.5.63 0 1.23-.13 1.77-.36l.98.98c-.88.24-1.8.38-2.75.38-3.79 0-7.17-2.13-8.82-5.5.7-1.43 1.72-2.61 2.93-3.53z"},null,-1)),$e=[xe,ye],Ie={key:1,xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#fff"},Se=T(()=>l("path",{d:"M0 0h24v24H0V0z",fill:"none"},null,-1)),Ne=T(()=>l("path",{d:"M12 6c3.79 0 7.17 2.13 8.82 5.5C19.17 14.87 15.79 17 12 17s-7.17-2.13-8.82-5.5C4.83 8.13 8.21 6 12 6m0-2C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4zm0 5c1.38 0 2.5 1.12 2.5 2.5S13.38 14 12 14s-2.5-1.12-2.5-2.5S10.62 9 12 9m0-2c-2.48 0-4.5 2.02-4.5 4.5S9.52 16 12 16s4.5-2.02 4.5-4.5S14.48 7 12 7z"},null,-1)),De=[Se,Ne],ke=N({setup(t){const e=k(),o=$(()=>e.state.config.food.schoolId),i=$(()=>e.state.config.food.open),n=g(),c=g(!1);C(o,()=>u()),C(i,()=>c.value=!!i.value),b(()=>{C(c,()=>{e.dispatch("config/setConfig",{food:{open:c.value}})})}),M(()=>clearInterval(f));const u=async()=>{var d;let p=new Date;const{data:s}=await S({url:`https://fatraceschool.k12ea.gov.tw/offered/meal?SchoolId=${o.value}&period=${[p.getFullYear(),p.getMonth()+1,p.getDate()].join("-")}&KitchenId=all`,method:"GET"});let h=(d=s==null?void 0:s.data)==null?void 0:d[0];if(h){const{data:a}=await S({url:`https://fatraceschool.k12ea.gov.tw/dish?BatchDataId=${h.BatchDataId}`,method:"GET"});n.value=a==null?void 0:a.data}},f=setInterval(u,1e3*60*10);return u(),(p,s)=>n.value?(v(),m("div",he,[D(le,{name:"content"},{default:se(()=>[I(l("div",pe,[(v(!0),m(L,null,O(n.value,(h,d)=>(v(),m("div",{class:"dish",key:d},[l("div",_e,[l("img",{src:`https://fatraceschool.k12ea.gov.tw/dish/pic/${h.DishId}`,alt:"\u83DC\u8272\u5716\u7247"},null,8,ve)]),l("div",me,[l("span",{textContent:w(h.DishType)},null,8,ge),l("span",{textContent:w(h.DishName)},null,8,Ce)])]))),128))],512),[[U,c.value]])]),_:1}),l("div",{class:"type",onClick:s[0]||(s[0]=h=>c.value=!c.value)},[c.value?(v(),m("svg",we,$e)):(v(),m("svg",Ie,De))])])):B("",!0)}});var Te=j(ke,[["__scopeId","data-v-35beb1d5"]]);const ze={class:"lave flex flex-item-center flex-center flex-down"},be=["textContent"],Me={class:"flex"},Be=["textContent"],Le=["textContent"],Oe=N({setup(t){const e=k(),o=$(()=>e.state.config.lave.laveTime);C(o,s=>s&&(n.value=s));const i=$(()=>e.state.config.lave.title||"\u6703\u8003\u5269\u9918"),n=g("2022-05-21T00:00:00+08:00"),c=g(),u=["\u5929","\u5C0F\u6642","\u5206\u9418","\u79D2"],f=()=>{let s=new Date(n.value).getTime()-new Date().getTime();c.value=[s/(1e3*60*60*24),s%(1e3*60*60*24)/(1e3*60*60),s%(1e3*60*60)/(1e3*60),s%(1e3*60)/1e3].map(d=>(~~d).toString().padStart(2,"0"));let h=c.value.map((d,a)=>[a,+d]).filter(([,d])=>d!==0)[0];document.title=`${i.value} ${h[1]||""}${u[h[0]]}`};f();const p=setInterval(f,100);return M(()=>clearInterval(p)),(s,h)=>(v(),m("div",ze,[l("div",{class:"title",textContent:w(x(i))},null,8,be),l("div",Me,[(v(),m(L,null,O(u,(d,a)=>{var r;return l("div",{class:"flex",key:a},[l("span",{class:"time",textContent:w((r=c.value)==null?void 0:r[a])},null,8,Be),l("span",{textContent:w(d)},null,8,Le)])}),64))])]))}});var Fe=j(Oe,[["__scopeId","data-v-caab62ca"]]);const z=t=>(K("data-v-6941eead"),t=t(),P(),t),Ve={key:0,class:"config"},Ae={key:0,class:"content"},Ee={class:"input"},je=z(()=>l("label",{for:"setTitle"},"\u5012\u8A08\u6642\u6A19\u984C:",-1)),Ge={class:"input"},He=z(()=>l("label",{for:"setDate"},"\u8A2D\u5B9A\u5230\u671F\u6642\u9593:",-1)),Ue={class:"input"},Ke=z(()=>l("label",{for:"schoolName"},"\u8ACB\u8F38\u5165\u5B78\u6821\u540D:(\u53EF\u9078)",-1)),Pe={class:"schools"},qe=["textContent","data-schoolId","data-schoolCode","data-schoolName"],Je=z(()=>l("svg",{xmlns:"http://www.w3.org/2000/svg",height:"24px",viewBox:"0 0 24 24",width:"24px",fill:"#fff"},[l("path",{d:"M0 0h24v24H0V0z",fill:"none"}),l("path",{d:"M19.43 12.98c.04-.32.07-.64.07-.98 0-.34-.03-.66-.07-.98l2.11-1.65c.19-.15.24-.42.12-.64l-2-3.46c-.09-.16-.26-.25-.44-.25-.06 0-.12.01-.17.03l-2.49 1c-.52-.4-1.08-.73-1.69-.98l-.38-2.65C14.46 2.18 14.25 2 14 2h-4c-.25 0-.46.18-.49.42l-.38 2.65c-.61.25-1.17.59-1.69.98l-2.49-1c-.06-.02-.12-.03-.18-.03-.17 0-.34.09-.43.25l-2 3.46c-.13.22-.07.49.12.64l2.11 1.65c-.04.32-.07.65-.07.98 0 .33.03.66.07.98l-2.11 1.65c-.19.15-.24.42-.12.64l2 3.46c.09.16.26.25.44.25.06 0 .12-.01.17-.03l2.49-1c.52.4 1.08.73 1.69.98l.38 2.65c.03.24.24.42.49.42h4c.25 0 .46-.18.49-.42l.38-2.65c.61-.25 1.17-.59 1.69-.98l2.49 1c.06.02.12.03.18.03.17 0 .34-.09.43-.25l2-3.46c.12-.22.07-.49-.12-.64l-2.11-1.65zm-1.98-1.71c.04.31.05.52.05.73 0 .21-.02.43-.05.73l-.14 1.13.89.7 1.08.84-.7 1.21-1.27-.51-1.04-.42-.9.68c-.43.32-.84.56-1.25.73l-1.06.43-.16 1.13-.2 1.35h-1.4l-.19-1.35-.16-1.13-1.06-.43c-.43-.18-.83-.41-1.23-.71l-.91-.7-1.06.43-1.27.51-.7-1.21 1.08-.84.89-.7-.14-1.13c-.03-.31-.05-.54-.05-.74s.02-.43.05-.73l.14-1.13-.89-.7-1.08-.84.7-1.21 1.27.51 1.04.42.9-.68c.43-.32.84-.56 1.25-.73l1.06-.43.16-1.13.2-1.35h1.39l.19 1.35.16 1.13 1.06.43c.43.18.83.41 1.23.71l.91.7 1.06-.43 1.27-.51.7 1.21-1.07.85-.89.7.14 1.13zM12 8c-2.21 0-4 1.79-4 4s1.79 4 4 4 4-1.79 4-4-1.79-4-4-4zm0 6c-1.1 0-2-.9-2-2s.9-2 2-2 2 .9 2 2-.9 2-2 2z"})],-1)),Re=[Je],We=N({setup(t){const e=k(),o=g(""),i=g(!1),n=g(),c=!!(chrome==null?void 0:chrome.storage),u=$(()=>e.state.config);let f=q({lave:{},food:{}}),p=q({data:[],result:1});C(u,()=>f=u.value),C(f,()=>e.dispatch("config/setConfig",y(_({},f),{$_updata:!0}))),b(()=>{S({method:"GET",url:"https://fatraceschool.k12ea.gov.tw/school"}).then(({data:d})=>p.data=d.data).catch()});let s;const h=d=>{s==null||s.classList.remove("highlighted"),s=d.target,s==null||s.classList.add("highlighted")};return(d,a)=>c?B("",!0):(v(),m("div",Ve,[i.value?(v(),m("div",Ae,[l("div",Ee,[je,I(l("input",{autocomplete:"off",type:"text",placeholder:"\u6703\u8003\u5269\u9918","onUpdate:modelValue":a[0]||(a[0]=r=>x(f).lave.title=r),id:"setTitle"},null,512),[[F,x(f).lave.title]])]),l("div",Ge,[He,I(l("input",{autocomplete:"off",type:"datetime-local","onUpdate:modelValue":a[1]||(a[1]=r=>x(f).lave.laveTime=r),id:"setDate"},null,512),[[F,x(f).lave.laveTime]])]),l("div",Ue,[Ke,I(l("input",{ref_key:"schoolConfig",ref:n,autocapitalize:"off",autocomplete:"off",spellcheck:"false",type:"search",placeholder:"\u8ACB\u8F38\u5165\u5B78\u6821\u540D","onUpdate:modelValue":a[2]||(a[2]=r=>o.value=r),id:"schoolName",onKeydown:[a[3]||(a[3]=J(()=>({}),["up"])),a[4]||(a[4]=J(()=>({}),["down"]))]},null,544),[[F,o.value]]),l("ul",Pe,[(v(!0),m(L,null,O(x(p).data.slice(0,20),(r,W)=>I((v(),m("li",{textContent:w(r.SchoolName),key:W,"data-schoolId":r.SchoolId,"data-schoolCode":r.SchoolCode,"data-schoolName":r.SchoolName,onMouseover:h},null,40,qe)),[[U,`${r.SchoolName},${r.SchoolCode},${r.SchoolId}`.includes(o.value)]])),128))])])])):B("",!0),l("div",{class:"icon",onClick:a[5]||(a[5]=r=>i.value=!i.value)},Re)]))}});var Ye=j(We,[["__scopeId","data-v-6941eead"]]);const Qe={class:"wrapper"},Xe=N({setup(t){const e=k();return b(()=>{if((chrome==null?void 0:chrome.storage)&&location.href.startsWith("chrome"))chrome.storage.onChanged.addListener(async({config:o})=>{o&&await e.dispatch("config/setConfig",y(_({},o.newValue),{$_updata:!1}))}),chrome.storage.local.get("config",({config:o})=>{o&&e.dispatch("config/setConfig",y(_({},o),{$_updata:!1}))});else{let o=new URL(location.href).searchParams;Object.keys(o).filter(i=>["endTitle","endTime","foodSchoolId","foodSchoolName"].includes(i))?e.dispatch("config/setConfig",{lave:{title:o.get("endTitle"),laveTime:o.get("endTime")},food:{schoolId:o.get("foodSchoolId"),schoolName:o.get("foodSchoolName")},$_updata:!1}):e.dispatch("config/setConfig",y(_({},JSON.parse(localStorage.getItem("config")||"{}")),{$_updata:!1}))}}),M(()=>{}),(o,i)=>(v(),m("div",Qe,[D(Fe),D(Te),D(Ye)]))}});ne(Xe).use(fe,R).mount("#app");
